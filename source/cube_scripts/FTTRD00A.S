; Do not change filenames or add or remove FILEI/FILEO statements using an editor. Use Cube/Application Manager.
RUN PGM=TRIPDIST MSG='Truck gravity model'
FILEO MATO[1] = "%SCENARIO_DIR%\TRK_TRIP_%ITER%.tmp",
 MO=1-3, DEC=D,D,D, NAME=SINGLEUNIT, COMBINATION, HV
FILEI LOOKUPI[1] = "%qrfm_ff%"
FILEI MATI[1] = "%SCENARIO_DIR%\TRK_SKIM_%ITER%.tmp"
FILEI ZDATI[1] = "%SCENARIO_DIR%\TRK_PA.txt",
 Z=#1, P1=#2, A1=#3, P2=#4, A2=#5 ;PA DATA

 MAXITERS=10
 MAXRMSE=10

 LOOKUP LOOKUPI=1, FAIL=120,0,0, LIST=N, 
 NAME=FF,  ;FRICTION FACTOR LOOKUP TABLE
 LOOKUP[1]=1, RESULT=2,
 LOOKUP[2]=1, RESULT=3,
 INTERPOLATE=Y, SETUPPER=N

 SETPA P[1]= P1, P[2] = P2
 SETPA A[1]= A1, A[2] = A2
          
 ;*****
 ;Define Friction Factors for Single Unit and Combination Trucks;
 ;Note: Use these as KFACTOR matrices, because FFACTORS cannot be in matrix form;
 ;*****
 MW[10]= MI.1.1
 MW[11]= MI.1.2

 GRAVITY PURPOSE=1, LOS=MW[10], FFACTORS=FF,  LOSRANGE=0-999   ;SINGLE UNIT GRAVITY MODEL
 FREQUENCY VALUEMW=1, BASEMW=10, RANGE=1-100, TITLE='SINGLE UNIT TRIPS'
  
 GRAVITY PURPOSE=2, LOS=MW[11], FFACTORS=FF,  LOSRANGE=0-999   ;COMBINATION GRAVITY MODEL
 FREQUENCY VALUEMW=1, BASEMW=11, RANGE=1-100, TITLE='COMBINATION TRIPS'

 MW[3] = MW[1]+ MW[2] ; TOTAL TRUCK TRIPS
ENDRUN
