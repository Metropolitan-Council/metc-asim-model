; Do not change filenames or add or remove FILEI/FILEO statements using an editor. Use Cube/Application Manager.
RUN PGM=MATRIX MSG='Update Zonal Database'
FILEI ZDATI[1] = "%SCENARIO_DIR%\zones_%PREV_ITER%.dbf"
FILEO RECO[1] = "%SCENARIO_DIR%\zones_%ITER%.dbf",
form=10.0,FIELDS=ZONE,ZONEID,POPULATION,HOUSEHOLDS,RET_EMP,NRET_EMP,AMC_EMP,MAN_EMP,OFF_EMP,MED1_EMP,MED2_EMP,RST_EMP,K12_EMP,ENT_EMP,TOT_EMP,
form=10.8,FIELDS=AREA,MIX_DENS,
form=10.0,FIELDS=TERM_TIME,
form=10.0,FIELDS=PARK_COST,NONWRKPRK,
form=10.0,FIELDS=ENROLLED,ENROLLED2,ENROLLED5,ENROLLED10,
form=10.8,FIELDS=TETRACC15,TEHWYACC10,REHWYACC10,NEHWYACC10,MEHWYACC10,
form=10.2,FIELDS=EXT_DIST,
form=10.0,FIELDS=CBD,SUBURB3,SUBURB2,RURAL,
form=10.8,FIELDS=HHDENSITY,LOGMXDENS,RETEMPDEN,POPDENS,TOTEMPDEN,TRHWACCRAT,
form=10.0,FIELDS=TW_ACC,SCH1NUM1,SCH1NUM2,SCH1NUM3,SCH1NUM4,SCH1NUM5,SCH1NUM6,SCH1NUM7,SCH1NUM8,SCH1NUM9,SCH1NUM10,SCH2NUM1,SCH2NUM2,SCH2NUM3,SCH2NUM4,SCH2NUM5,SCH2NUM6,SCH2NUM7,SCH2NUM8,SCH2NUM9,SCH2NUM10,SCH3NUM1,SCH3NUM2,SCH3NUM3,SCH3NUM4,SCH3NUM5,SCH3NUM6,SCH3NUM7,SCH3NUM8,SCH3NUM9,SCH3NUM10,DISTRICT
FILEI ZDATI[6] = "%SCENARIO_DIR%\universityenrollment.csv",
 Z=#1,ENROLLED2=#3,ENROLLED5=#4,ENROLLED10=#5
FILEI ZDATI[5] = "%SCENARIO_DIR%\TAZ_SchoolList.csv",
 Z=#1,SCH1NUM1=#2,SCH1NUM2=#3,SCH1NUM3=#4,SCH1NUM4=#5,SCH1NUM5=#6,SCH1NUM6=#7,SCH1NUM7=#8,SCH1NUM8=#9,SCH1NUM9=#10,SCH1NUM10=#11,SCH2NUM1=#12,SCH2NUM2=#13,SCH2NUM3=#14,SCH2NUM4=#15,SCH2NUM5=#16,SCH2NUM6=#17,SCH2NUM7=#18,SCH2NUM8=#19,SCH2NUM9=#20,SCH2NUM10=#21,SCH3NUM1=#22,SCH3NUM2=#23,SCH3NUM3=#24,SCH3NUM4=#25,SCH3NUM5=#26,SCH3NUM6=#27,SCH3NUM7=#28,SCH3NUM8=#29,SCH3NUM9=#30,SCH3NUM10=#31
FILEI ZDATI[4] = "%SCENARIO_DIR%\distancetoexternal.csv",
 Z=#1,EXT_DIST=#2
FILEI ZDATI[3] = "%SCENARIO_DIR%\transit_accessibility.csv",
 Z=#1,TETRACC15=#6
FILEI ZDATI[2] = "%SCENARIO_DIR%\highway_accessibility.csv",
 Z=#1,TEHWYACC10=#5,REHWYACC10=#11,NEHWYACC10=#17,MEHWYACC10=#23


ZONES=%int_zones%

; Update all variables
ro.ZONE=zi.1.ZONE[i]
ro.ZONEID=zi.1.ZONEID[i]
ro.POPULATION=zi.1.POPULATION[i]
ro.HOUSEHOLDS=zi.1.HOUSEHOLDS[i]
ro.RET_EMP=zi.1.RET_EMP[i]
ro.NRET_EMP=zi.1.NRET_EMP[i]
ro.AMC_EMP=zi.1.AMC_EMP[i]
ro.MAN_EMP=zi.1.MAN_EMP[i]
ro.OFF_EMP=zi.1.OFF_EMP[i]
ro.MED1_EMP=zi.1.MED1_EMP[i]
ro.MED2_EMP=zi.1.MED2_EMP[i]
ro.RST_EMP=zi.1.RST_EMP[i]
ro.K12_EMP=zi.1.K12_EMP[i]
ro.ENT_EMP=zi.1.ENT_EMP[i]
ro.TOT_EMP=zi.1.TOT_EMP[i]
ro.AREA=zi.1.AREA[i]
ro.MIX_DENS=zi.1.MIX_DENS[i]
ro.TERM_TIME=zi.1.TERM_TIME[i]
ro.PARK_COST=zi.1.PARK_COST[i]
ro.NONWRKPRK=zi.1.NONWRKPRK[i]
ro.ENROLLED=zi.1.ENROLLED[i]
ro.ENROLLED2=zi.6.ENROLLED2[i]
ro.ENROLLED5=zi.6.ENROLLED5[i]
ro.ENROLLED10=zi.6.ENROLLED10[i]
ro.TETRACC15=zi.3.TETRACC15[i]
ro.TEHWYACC10=zi.2.TEHWYACC10[i]
ro.REHWYACC10=zi.2.REHWYACC10[i]
ro.NEHWYACC10=zi.2.NEHWYACC10[i]
ro.MEHWYACC10=zi.2.MEHWYACC10[i]
ro.EXT_DIST=zi.4.EXT_DIST[i]
ro.CBD=zi.1.CBD[i]
ro.SUBURB3=zi.1.SUBURB3[i]
ro.SUBURB2=zi.1.SUBURB2[i]
ro.RURAL=zi.1.RURAL[i]
ro.HHDENSITY=zi.1.HHDENSITY[i]
ro.LOGMXDENS=zi.1.LOGMXDENS[i]
ro.RETEMPDEN=zi.1.RETEMPDEN[i]
ro.POPDENS=zi.1.POPDENS[i]
ro.TOTEMPDEN=zi.1.TOTEMPDEN[i]
ro.TRHWACCRAT=zi.1.TRHWACCRAT[i]
ro.TW_ACC=zi.1.TW_ACC[i]
ro.SCH1NUM1=zi.5.SCH1NUM1[i]
ro.SCH1NUM2=zi.5.SCH1NUM2[i]
ro.SCH1NUM3=zi.5.SCH1NUM3[i]
ro.SCH1NUM4=zi.5.SCH1NUM4[i]
ro.SCH1NUM5=zi.5.SCH1NUM5[i]
ro.SCH1NUM6=zi.5.SCH1NUM6[i]
ro.SCH1NUM7=zi.5.SCH1NUM7[i]
ro.SCH1NUM8=zi.5.SCH1NUM8[i]
ro.SCH1NUM9=zi.5.SCH1NUM9[i]
ro.SCH1NUM10=zi.5.SCH1NUM10[i]
ro.SCH2NUM1=zi.5.SCH2NUM1[i]
ro.SCH2NUM2=zi.5.SCH2NUM2[i]
ro.SCH2NUM3=zi.5.SCH2NUM3[i]
ro.SCH2NUM4=zi.5.SCH2NUM4[i]
ro.SCH2NUM5=zi.5.SCH2NUM5[i]
ro.SCH2NUM6=zi.5.SCH2NUM6[i]
ro.SCH2NUM7=zi.5.SCH2NUM7[i]
ro.SCH2NUM8=zi.5.SCH2NUM8[i]
ro.SCH2NUM9=zi.5.SCH2NUM9[i]
ro.SCH2NUM10=zi.5.SCH2NUM10[i]
ro.SCH3NUM1=zi.5.SCH3NUM1[i]
ro.SCH3NUM2=zi.5.SCH3NUM2[i]
ro.SCH3NUM3=zi.5.SCH3NUM3[i]
ro.SCH3NUM4=zi.5.SCH3NUM4[i]
ro.SCH3NUM5=zi.5.SCH3NUM5[i]
ro.SCH3NUM6=zi.5.SCH3NUM6[i]
ro.SCH3NUM7=zi.5.SCH3NUM7[i]
ro.SCH3NUM8=zi.5.SCH3NUM8[i]
ro.SCH3NUM9=zi.5.SCH3NUM9[i]
ro.SCH3NUM10=zi.5.SCH3NUM10[i]
ro.DISTRICT=zi.1.DISTRICT[i]

; create output dbf
write reco=1

ENDRUN
