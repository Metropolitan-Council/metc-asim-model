RUN PGM = MATRIX MSG='Prepare Transit Skims for ActivitySim'
FILEI MATI[1] = "%SCENARIO_DIR%\transit\XIT_WK_SKIM_%PREV_ITER%_EA.skm"
FILEI MATI[2] = "%SCENARIO_DIR%\transit\XIT_WK_SKIM_%PREV_ITER%_AM.skm"
FILEI MATI[3] = "%SCENARIO_DIR%\transit\XIT_WK_SKIM_%PREV_ITER%_MD.skm"
FILEI MATI[4] = "%SCENARIO_DIR%\transit\XIT_WK_SKIM_%PREV_ITER%_PM.skm"
FILEI MATI[5] = "%SCENARIO_DIR%\transit\XIT_WK_SKIM_%PREV_ITER%_NT.skm"

FILEI MATI[6] = "%SCENARIO_DIR%\transit\XIT_DR_SKIM_%PREV_ITER%_EA.skm"
FILEI MATI[7] = "%SCENARIO_DIR%\transit\XIT_DR_SKIM_%PREV_ITER%_AM.skm"
FILEI MATI[8] = "%SCENARIO_DIR%\transit\XIT_DR_SKIM_%PREV_ITER%_MD.skm"
FILEI MATI[9] = "%SCENARIO_DIR%\transit\XIT_DR_SKIM_%PREV_ITER%_PM.skm"
FILEI MATI[10] = "%SCENARIO_DIR%\transit\XIT_DR_SKIM_%PREV_ITER%_NT.skm"

FILEI MATI[11] = "%SCENARIO_DIR%\transit\XIT_DRE_SKIM_%PREV_ITER%_EA.skm"
FILEI MATI[12] = "%SCENARIO_DIR%\transit\XIT_DRE_SKIM_%PREV_ITER%_AM.skm"
FILEI MATI[13] = "%SCENARIO_DIR%\transit\XIT_DRE_SKIM_%PREV_ITER%_MD.skm"
FILEI MATI[14] = "%SCENARIO_DIR%\transit\XIT_DRE_SKIM_%PREV_ITER%_PM.skm"
FILEI MATI[15] = "%SCENARIO_DIR%\transit\XIT_DRE_SKIM_%PREV_ITER%_NT.skm"

FILEO MATO[1] = "%SCENARIO_DIR%\transit\trnskims_%PREV_ITER%.mat", MO = 1-215,
NAME = IVT_Bus_WK__EA,IVT_LB_WK__EA,IVT_Exp_WK__EA,IVT_LRT_WK__EA,IVT_CRT_WK__EA,WAIT1_WK__EA,WAIT2_WK__EA,XFERS_WK__EA,AWALKT_WK__EA,XWALKT_WK__EA,FARE_WK__EA,XBFARE_WK__EA,CRTFare_WK__EA,
	IVT_Bus_DR__EA,IVT_LB_DR__EA,IVT_Exp_DR__EA,IVT_LRT_DR__EA,IVT_CRT_DR__EA,WAIT1_DR__EA,WAIT2_DR__EA,XFERS_DR__EA,AWALKT_DR__EA,XWALKT_DR__EA,FARE_DR__EA,XBFARE_DR__EA,CRTFare_DR__EA,DR_ACCR_DR__EA,DR_ACCD_DR__EA,
	IVT_Bus_DE__EA,IVT_LB_DE__EA,IVT_Exp_DE__EA,IVT_LRT_DE__EA,IVT_CRT_DE__EA,WAIT1_DE__EA,WAIT2_DE__EA,XFERS_DE__EA,AWALKT_DE__EA,XWALKT_DE__EA,FARE_DE__EA,XBFARE_DE__EA,CRTFare_DE__EA,DR_ACCR_DE__EA,DR_ACCD_DE__EA,	
	IVT_Bus_WK__AM,IVT_LB_WK__AM,IVT_Exp_WK__AM,IVT_LRT_WK__AM,IVT_CRT_WK__AM,WAIT1_WK__AM,WAIT2_WK__AM,XFERS_WK__AM,AWALKT_WK__AM,XWALKT_WK__AM,FARE_WK__AM,XBFARE_WK__AM,CRTFare_WK__AM,
	IVT_Bus_DR__AM,IVT_LB_DR__AM,IVT_Exp_DR__AM,IVT_LRT_DR__AM,IVT_CRT_DR__AM,WAIT1_DR__AM,WAIT2_DR__AM,XFERS_DR__AM,AWALKT_DR__AM,XWALKT_DR__AM,FARE_DR__AM,XBFARE_DR__AM,CRTFare_DR__AM,DR_ACCR_DR__AM,DR_ACCD_DR__AM,
	IVT_Bus_DE__AM,IVT_LB_DE__AM,IVT_Exp_DE__AM,IVT_LRT_DE__AM,IVT_CRT_DE__AM,WAIT1_DE__AM,WAIT2_DE__AM,XFERS_DE__AM,AWALKT_DE__AM,XWALKT_DE__AM,FARE_DE__AM,XBFARE_DE__AM,CRTFare_DE__AM,DR_ACCR_DE__AM,DR_ACCD_DE__AM,	
	IVT_Bus_WK__MD,IVT_LB_WK__MD,IVT_Exp_WK__MD,IVT_LRT_WK__MD,IVT_CRT_WK__MD,WAIT1_WK__MD,WAIT2_WK__MD,XFERS_WK__MD,AWALKT_WK__MD,XWALKT_WK__MD,FARE_WK__MD,XBFARE_WK__MD,CRTFare_WK__MD,
	IVT_Bus_DR__MD,IVT_LB_DR__MD,IVT_Exp_DR__MD,IVT_LRT_DR__MD,IVT_CRT_DR__MD,WAIT1_DR__MD,WAIT2_DR__MD,XFERS_DR__MD,AWALKT_DR__MD,XWALKT_DR__MD,FARE_DR__MD,XBFARE_DR__MD,CRTFare_DR__MD,DR_ACCR_DR__MD,DR_ACCD_DR__MD,
	IVT_Bus_DE__MD,IVT_LB_DE__MD,IVT_Exp_DE__MD,IVT_LRT_DE__MD,IVT_CRT_DE__MD,WAIT1_DE__MD,WAIT2_DE__MD,XFERS_DE__MD,AWALKT_DE__MD,XWALKT_DE__MD,FARE_DE__MD,XBFARE_DE__MD,CRTFare_DE__MD,DR_ACCR_DE__MD,DR_ACCD_DE__MD,	
	IVT_Bus_WK__PM,IVT_LB_WK__PM,IVT_Exp_WK__PM,IVT_LRT_WK__PM,IVT_CRT_WK__PM,WAIT1_WK__PM,WAIT2_WK__PM,XFERS_WK__PM,AWALKT_WK__PM,XWALKT_WK__PM,FARE_WK__PM,XBFARE_WK__PM,CRTFare_WK__PM,
	IVT_Bus_DR__PM,IVT_LB_DR__PM,IVT_Exp_DR__PM,IVT_LRT_DR__PM,IVT_CRT_DR__PM,WAIT1_DR__PM,WAIT2_DR__PM,XFERS_DR__PM,AWALKT_DR__PM,XWALKT_DR__PM,FARE_DR__PM,XBFARE_DR__PM,CRTFare_DR__PM,DR_ACCR_DR__PM,DR_ACCD_DR__PM,
	IVT_Bus_DE__PM,IVT_LB_DE__PM,IVT_Exp_DE__PM,IVT_LRT_DE__PM,IVT_CRT_DE__PM,WAIT1_DE__PM,WAIT2_DE__PM,XFERS_DE__PM,AWALKT_DE__PM,XWALKT_DE__PM,FARE_DE__PM,XBFARE_DE__PM,CRTFare_DE__PM,DR_ACCR_DE__PM,DR_ACCD_DE__PM,
	IVT_Bus_WK__NT,IVT_LB_WK__NT,IVT_Exp_WK__NT,IVT_LRT_WK__NT,IVT_CRT_WK__NT,WAIT1_WK__NT,WAIT2_WK__NT,XFERS_WK__NT,AWALKT_WK__NT,XWALKT_WK__NT,FARE_WK__NT,XBFARE_WK__NT,CRTFare_WK__NT,
	IVT_Bus_DR__NT,IVT_LB_DR__NT,IVT_Exp_DR__NT,IVT_LRT_DR__NT,IVT_CRT_DR__NT,WAIT1_DR__NT,WAIT2_DR__NT,XFERS_DR__NT,AWALKT_DR__NT,XWALKT_DR__NT,FARE_DR__NT,XBFARE_DR__NT,CRTFare_DR__NT,DR_ACCR_DR__NT,DR_ACCD_DR__NT,
	IVT_Bus_DE__NT,IVT_LB_DE__NT,IVT_Exp_DE__NT,IVT_LRT_DE__NT,IVT_CRT_DE__NT,WAIT1_DE__NT,WAIT2_DE__NT,XFERS_DE__NT,AWALKT_DE__NT,XWALKT_DE__NT,FARE_DE__NT,XBFARE_DE__NT,CRTFare_DE__NT,DR_ACCR_DE__NT,DR_ACCD_DE__NT

DISTRIBUTEINTRASTEP ProcessID='Intrastep', ProcessList=1-%max_threads%

; EA Walk Skims
MW[01] = MI.1.IVT_Bus
MW[02] = MI.1.IVT_LB
MW[03] = MI.1.IVT_Exp
MW[04] = MI.1.IVT_LRT
MW[05] = MI.1.IVT_CRT
MW[06] = MI.1.WAIT1
MW[07] = MI.1.WAIT2
MW[08] = MI.1.XFERS
MW[09] = MI.1.AWALKT
MW[10] = MI.1.XWALKT
MW[11] = MI.1.FARE
MW[12] = MI.1.XBFARE
MW[13] = MI.1.CRTFare

; EA Drive Access Skims
MW[14] = MI.6.IVT_Bus
MW[15] = MI.6.IVT_LB
MW[16] = MI.6.IVT_Exp
MW[17] = MI.6.IVT_LRT
MW[18] = MI.6.IVT_CRT
MW[19] = MI.6.WAIT1
MW[20] = MI.6.WAIT2
MW[21] = MI.6.XFERS
MW[22] = MI.6.AWALKT
MW[23] = MI.6.XWALKT
MW[24] = MI.6.FARE
MW[25] = MI.6.XBFARE
MW[26] = MI.6.CRTFare
MW[27] = MI.6.DR_ACCR
MW[28] = MI.6.DR_ACCD

; EA Drive Egress Skims
MW[29] = MI.11.IVT_Bus
MW[30] = MI.11.IVT_LB
MW[31] = MI.11.IVT_Exp
MW[32] = MI.11.IVT_LRT
MW[33] = MI.11.IVT_CRT
MW[34] = MI.11.WAIT1
MW[35] = MI.11.WAIT2
MW[36] = MI.11.XFERS
MW[37] = MI.11.AWALKT
MW[38] = MI.11.XWALKT
MW[39] = MI.11.FARE
MW[40] = MI.11.XBFARE
MW[41] = MI.11.CRTFare
MW[42] = MI.11.DR_ACCR
MW[43] = MI.11.DR_ACCD

; AM Walk Skims
MW[44] = MI.2.IVT_Bus
MW[45] = MI.2.IVT_LB
MW[46] = MI.2.IVT_Exp
MW[47] = MI.2.IVT_LRT
MW[48] = MI.2.IVT_CRT
MW[49] = MI.2.WAIT1
MW[50] = MI.2.WAIT2
MW[51] = MI.2.XFERS
MW[52] = MI.2.AWALKT
MW[53] = MI.2.XWALKT
MW[54] = MI.2.FARE
MW[55] = MI.2.XBFARE
MW[56] = MI.2.CRTFare

; AM Drive Access Skims
MW[57] = MI.7.IVT_Bus
MW[58] = MI.7.IVT_LB
MW[59] = MI.7.IVT_Exp
MW[60] = MI.7.IVT_LRT
MW[61] = MI.7.IVT_CRT
MW[62] = MI.7.WAIT1
MW[63] = MI.7.WAIT2
MW[64] = MI.7.XFERS
MW[65] = MI.7.AWALKT
MW[66] = MI.7.XWALKT
MW[67] = MI.7.FARE
MW[68] = MI.7.XBFARE
MW[69] = MI.7.CRTFare
MW[70] = MI.7.DR_ACCR
MW[71] = MI.7.DR_ACCD

; AM Drive Egress Skims
MW[72] = MI.12.IVT_Bus
MW[73] = MI.12.IVT_LB
MW[74] = MI.12.IVT_Exp
MW[75] = MI.12.IVT_LRT
MW[76] = MI.12.IVT_CRT
MW[77] = MI.12.WAIT1
MW[78] = MI.12.WAIT2
MW[79] = MI.12.XFERS
MW[80] = MI.12.AWALKT
MW[81] = MI.12.XWALKT
MW[82] = MI.12.FARE
MW[83] = MI.12.XBFARE
MW[84] = MI.12.CRTFare
MW[85] = MI.12.DR_ACCR
MW[86] = MI.12.DR_ACCD

; MD Walk Skims
MW[87] = MI.3.IVT_Bus
MW[88] = MI.3.IVT_LB
MW[89] = MI.3.IVT_Exp
MW[90] = MI.3.IVT_LRT
MW[91] = MI.3.IVT_CRT
MW[92] = MI.3.WAIT1
MW[93] = MI.3.WAIT2
MW[94] = MI.3.XFERS
MW[95] = MI.3.AWALKT
MW[96] = MI.3.XWALKT
MW[97] = MI.3.FARE
MW[98] = MI.3.XBFARE
MW[99] = MI.3.CRTFare

; MD Drive Access Skims
MW[100] = MI.8.IVT_Bus
MW[101] = MI.8.IVT_LB
MW[102] = MI.8.IVT_Exp
MW[103] = MI.8.IVT_LRT
MW[104] = MI.8.IVT_CRT
MW[105] = MI.8.WAIT1
MW[106] = MI.8.WAIT2
MW[107] = MI.8.XFERS
MW[108] = MI.8.AWALKT
MW[109] = MI.8.XWALKT
MW[110] = MI.8.FARE
MW[111] = MI.8.XBFARE
MW[112] = MI.8.CRTFare
MW[113] = MI.8.DR_ACCR
MW[114] = MI.8.DR_ACCD

; MD Drive Egress Skims
MW[115] = MI.13.IVT_Bus
MW[116] = MI.13.IVT_LB
MW[117] = MI.13.IVT_Exp
MW[118] = MI.13.IVT_LRT
MW[119] = MI.13.IVT_CRT
MW[120] = MI.13.WAIT1
MW[121] = MI.13.WAIT2
MW[122] = MI.13.XFERS
MW[123] = MI.13.AWALKT
MW[124] = MI.13.XWALKT
MW[125] = MI.13.FARE
MW[126] = MI.13.XBFARE
MW[127] = MI.13.CRTFare
MW[128] = MI.13.DR_ACCR
MW[129] = MI.13.DR_ACCD

; PM Walk Skims
MW[130] = MI.4.IVT_Bus
MW[131] = MI.4.IVT_LB
MW[132] = MI.4.IVT_Exp
MW[133] = MI.4.IVT_LRT
MW[134] = MI.4.IVT_CRT
MW[135] = MI.4.WAIT1
MW[136] = MI.4.WAIT2
MW[137] = MI.4.XFERS
MW[138] = MI.4.AWALKT
MW[139] = MI.4.XWALKT
MW[140] = MI.4.FARE
MW[141] = MI.4.XBFARE
MW[142] = MI.4.CRTFare

; PM Drive Access Skims
MW[143] = MI.9.IVT_Bus
MW[144] = MI.9.IVT_LB
MW[145] = MI.9.IVT_Exp
MW[146] = MI.9.IVT_LRT
MW[147] = MI.9.IVT_CRT
MW[148] = MI.9.WAIT1
MW[149] = MI.9.WAIT2
MW[150] = MI.9.XFERS
MW[151] = MI.9.AWALKT
MW[152] = MI.9.XWALKT
MW[153] = MI.9.FARE
MW[154] = MI.9.XBFARE
MW[155] = MI.9.CRTFare
MW[156] = MI.9.DR_ACCR
MW[157] = MI.9.DR_ACCD

; PM Drive Egress Skims
MW[158] = MI.14.IVT_Bus
MW[159] = MI.14.IVT_LB
MW[160] = MI.14.IVT_Exp
MW[161] = MI.14.IVT_LRT
MW[162] = MI.14.IVT_CRT
MW[163] = MI.14.WAIT1
MW[164] = MI.14.WAIT2
MW[165] = MI.14.XFERS
MW[166] = MI.14.AWALKT
MW[167] = MI.14.XWALKT
MW[168] = MI.14.FARE
MW[169] = MI.14.XBFARE
MW[170] = MI.14.CRTFare
MW[171] = MI.14.DR_ACCR
MW[172] = MI.14.DR_ACCD

; NT Walk Skims
MW[173] = MI.5.IVT_Bus
MW[174] = MI.5.IVT_LB
MW[175] = MI.5.IVT_Exp
MW[176] = MI.5.IVT_LRT
MW[177] = MI.5.IVT_CRT
MW[178] = MI.5.WAIT1
MW[179] = MI.5.WAIT2
MW[180] = MI.5.XFERS
MW[181] = MI.5.AWALKT
MW[182] = MI.5.XWALKT
MW[183] = MI.5.FARE
MW[184] = MI.5.XBFARE
MW[185] = MI.5.CRTFare

; NT Drive Access Skims
MW[186] = MI.10.IVT_Bus
MW[187] = MI.10.IVT_LB
MW[188] = MI.10.IVT_Exp
MW[189] = MI.10.IVT_LRT
MW[190] = MI.10.IVT_CRT
MW[191] = MI.10.WAIT1
MW[192] = MI.10.WAIT2
MW[193] = MI.10.XFERS
MW[194] = MI.10.AWALKT
MW[195] = MI.10.XWALKT
MW[196] = MI.10.FARE
MW[197] = MI.10.XBFARE
MW[198] = MI.10.CRTFare
MW[199] = MI.10.DR_ACCR
MW[200] = MI.10.DR_ACCD

; NT Drive Egress Skims
MW[201] = MI.15.IVT_Bus
MW[202] = MI.15.IVT_LB
MW[203] = MI.15.IVT_Exp
MW[204] = MI.15.IVT_LRT
MW[205] = MI.15.IVT_CRT
MW[206] = MI.15.WAIT1
MW[207] = MI.15.WAIT2
MW[208] = MI.15.XFERS
MW[209] = MI.15.AWALKT
MW[210] = MI.1.XWALKT
MW[211] = MI.15.FARE
MW[212] = MI.15.XBFARE
MW[213] = MI.15.CRTFare
MW[214] = MI.15.DR_ACCR
MW[215] = MI.15.DR_ACCD

ENDRUN

RUN PGM = MATRIX MSG='Prepare Skims for ActivitySim (Low VoT)'
FILEI MATI[1] = "%SCENARIO_DIR%\highway\HWY_SKIM_%PREV_ITER%_AM_L.skm"
FILEI MATI[2] = "%SCENARIO_DIR%\highway\HWY_SKIM_%PREV_ITER%_MD_L.skm"
FILEI MATI[3] = "%SCENARIO_DIR%\highway\HWY_SKIM_%PREV_ITER%_PM_L.skm"
FILEI MATI[4] = "%SCENARIO_DIR%\highway\HWY_SKIM_%PREV_ITER%_NT_L.skm"
FILEO MATO[1] = "%SCENARIO_DIR%\highway\allskims_%PREV_ITER%_L.mat",  MO=1-60, 1-15,
NAME=
	SOV_P_TIME_L__EA, SOV_P_TOLL_L__EA, SOV_N_TIME_L__EA, SOV_N_TOLL_L__EA, SOV_DIST_L__EA, 
	HOV2_P_TIME_L__EA, HOV2_P_TOLL_L__EA, HOV2_N_TIME_L__EA, HOV2_N_TOLL_L__EA, HOV2_DIST_L__EA, 
	HOV3_P_TIME_L__EA, HOV3_P_TOLL_L__EA, HOV3_N_TIME_L__EA, HOV3_N_TOLL_L__EA, HOV3_DIST_L__EA, 
	SOV_P_TIME_L__AM, SOV_P_TOLL_L__AM, SOV_N_TIME_L__AM, SOV_N_TOLL_L__AM, SOV_DIST_L__AM, 
	HOV2_P_TIME_L__AM, HOV2_P_TOLL_L__AM, HOV2_N_TIME_L__AM, HOV2_N_TOLL_L__AM, HOV2_DIST_L__AM,
	HOV3_P_TIME_L__AM, HOV3_P_TOLL_L__AM, HOV3_N_TIME_L__AM, HOV3_N_TOLL_L__AM, HOV3_DIST_L__AM, 
	SOV_P_TIME_L__MD, SOV_P_TOLL_L__MD, SOV_N_TIME_L__MD, SOV_N_TOLL_L__MD, SOV_DIST_L__MD,
	HOV2_P_TIME_L__MD, HOV2_P_TOLL_L__MD, HOV2_N_TIME_L__MD, HOV2_N_TOLL_L__MD, HOV2_DIST_L__MD, 
	HOV3_P_TIME_L__MD, HOV3_P_TOLL_L__MD, HOV3_N_TIME_L__MD, HOV3_N_TOLL_L__MD, HOV3_DIST_L__MD, 
	SOV_P_TIME_L__PM, SOV_P_TOLL_L__PM, SOV_N_TIME_L__PM, SOV_N_TOLL_L__PM, SOV_DIST_L__PM, 
	HOV2_P_TIME_L__PM, HOV2_P_TOLL_L__PM, HOV2_N_TIME_L__PM, HOV2_N_TOLL_L__PM, HOV2_DIST_L__PM, 
	HOV3_P_TIME_L__PM, HOV3_P_TOLL_L__PM, HOV3_N_TIME_L__PM, HOV3_N_TOLL_L__PM, HOV3_DIST_L__PM, 
	SOV_P_TIME_L__NT, SOV_P_TOLL_L__NT, SOV_N_TIME_L__NT, SOV_N_TOLL_L__NT, SOV_DIST_L__NT, 
	HOV2_P_TIME_L__NT, HOV2_P_TOLL_L__NT, HOV2_N_TIME_L__NT, HOV2_N_TOLL_L__NT, HOV2_DIST_L__NT, 
	HOV3_P_TIME_L__NT, HOV3_P_TOLL_L__NT, HOV3_N_TIME_L__NT, HOV3_N_TOLL_L__NT, HOV3_DIST_L__NT
	
DISTRIBUTEINTRASTEP ProcessID='Intrastep', ProcessList=1-%max_threads%

; EA skims - use NT
MW[1] = MI.4.daptime
MW[2] = MI.4.daptoll
MW[3] = MI.4.dantime
MW[4] = MI.4.dantoll
MW[5] = MI.4.dapdist
MW[6] = MI.4.a2ptime
MW[7] = MI.4.a2ptoll
MW[8] = MI.4.a2ntime
MW[9] = MI.4.a2ntoll
MW[10] = MI.4.a2pdist
MW[11] = MI.4.a3ptime
MW[12] = MI.4.a3ptoll
MW[13] = MI.4.a3ntime
MW[14] = MI.4.a3ntoll
MW[15] = MI.4.a3pdist

; AM Skims
MW[16] = MI.1.daptime
MW[17] = MI.1.daptoll
MW[18] = MI.1.dantime
MW[19] = MI.1.dantoll
MW[20] = MI.1.dapdist
MW[21] = MI.1.a2ptime
MW[22] = MI.1.a2ptoll
MW[23] = MI.1.a2ntime
MW[24] = MI.1.a2ntoll
MW[25] = MI.1.a2pdist
MW[26] = MI.1.a3ptime
MW[27] = MI.1.a3ptoll
MW[28] = MI.1.a3ntime
MW[29] = MI.1.a3ntoll
MW[30] = MI.1.a3pdist

; MD Skims
MW[31] = MI.2.daptime
MW[32] = MI.2.daptoll
MW[33] = MI.2.dantime
MW[34] = MI.2.dantoll
MW[35] = MI.2.dapdist
MW[36] = MI.2.a2ptime
MW[37] = MI.2.a2ptoll
MW[38] = MI.2.a2ntime
MW[39] = MI.2.a2ntoll
MW[40] = MI.2.a2pdist
MW[41] = MI.2.a3ptime
MW[42] = MI.2.a3ptoll
MW[43] = MI.2.a3ntime
MW[44] = MI.2.a3ntoll
MW[45] = MI.2.a3pdist

; PM Skims
MW[46] = MI.3.daptime
MW[47] = MI.3.daptoll
MW[48] = MI.3.dantime
MW[49] = MI.3.dantoll
MW[50] = MI.3.dapdist
MW[51] = MI.3.a2ptime
MW[52] = MI.3.a2ptoll
MW[53] = MI.3.a2ntime
MW[54] = MI.3.a2ntoll
MW[55] = MI.3.a2pdist
MW[56] = MI.3.a3ptime
MW[57] = MI.3.a3ptoll
MW[58] = MI.3.a3ntime
MW[59] = MI.3.a3ntoll
MW[60] = MI.3.a3pdist

ENDRUN

RUN PGM = MATRIX MSG='Prepare Skims for ActivitySim (Mid VoT)'
FILEI MATI[1] = "%SCENARIO_DIR%\highway\HWY_SKIM_%PREV_ITER%_AM_M.skm"
FILEI MATI[2] = "%SCENARIO_DIR%\highway\HWY_SKIM_%PREV_ITER%_MD_M.skm"
FILEI MATI[3] = "%SCENARIO_DIR%\highway\HWY_SKIM_%PREV_ITER%_PM_M.skm"
FILEI MATI[4] = "%SCENARIO_DIR%\highway\HWY_SKIM_%PREV_ITER%_NT_M.skm"
FILEO MATO[1] = "%SCENARIO_DIR%\highway\allskims_%PREV_ITER%_M.mat",  MO=1-60, 1-15, 5, 
NAME=
	SOV_P_TIME_M__EA, SOV_P_TOLL_M__EA, SOV_N_TIME_M__EA, SOV_N_TOLL_M__EA, SOV_DIST_M__EA, 
	HOV2_P_TIME_M__EA, HOV2_P_TOLL_M__EA, HOV2_N_TIME_M__EA, HOV2_N_TOLL_M__EA, HOV2_DIST_M__EA, 
	HOV3_P_TIME_M__EA, HOV3_P_TOLL_M__EA, HOV3_N_TIME_M__EA, HOV3_N_TOLL_M__EA, HOV3_DIST_M__EA, 
	SOV_P_TIME_M__AM, SOV_P_TOLL_M__AM, SOV_N_TIME_M__AM, SOV_N_TOLL_M__AM, SOV_DIST_M__AM, 
	HOV2_P_TIME_M__AM, HOV2_P_TOLL_M__AM, HOV2_N_TIME_M__AM, HOV2_N_TOLL_M__AM, HOV2_DIST_M__AM,
	HOV3_P_TIME_M__AM, HOV3_P_TOLL_M__AM, HOV3_N_TIME_M__AM, HOV3_N_TOLL_M__AM, HOV3_DIST_M__AM, 
	SOV_P_TIME_M__MD, SOV_P_TOLL_M__MD, SOV_N_TIME_M__MD, SOV_N_TOLL_M__MD, SOV_DIST_M__MD,
	HOV2_P_TIME_M__MD, HOV2_P_TOLL_M__MD, HOV2_N_TIME_M__MD, HOV2_N_TOLL_M__MD, HOV2_DIST_M__MD, 
	HOV3_P_TIME_M__MD, HOV3_P_TOLL_M__MD, HOV3_N_TIME_M__MD, HOV3_N_TOLL_M__MD, HOV3_DIST_M__MD, 
	SOV_P_TIME_M__PM, SOV_P_TOLL_M__PM, SOV_N_TIME_M__PM, SOV_N_TOLL_M__PM, SOV_DIST_M__PM, 
	HOV2_P_TIME_M__PM, HOV2_P_TOLL_M__PM, HOV2_N_TIME_M__PM, HOV2_N_TOLL_M__PM, HOV2_DIST_M__PM, 
	HOV3_P_TIME_M__PM, HOV3_P_TOLL_M__PM, HOV3_N_TIME_M__PM, HOV3_N_TOLL_M__PM, HOV3_DIST_M__PM, 
	SOV_P_TIME_M__NT, SOV_P_TOLL_M__NT, SOV_N_TIME_M__NT, SOV_N_TOLL_M__NT, SOV_DIST_M__NT, 
	HOV2_P_TIME_M__NT, HOV2_P_TOLL_M__NT, HOV2_N_TIME_M__NT, HOV2_N_TOLL_M__NT, HOV2_DIST_M__NT, 
	HOV3_P_TIME_M__NT, HOV3_P_TOLL_M__NT, HOV3_N_TIME_M__NT, HOV3_N_TOLL_M__NT, HOV3_DIST_M__NT,
	DIST
	
DISTRIBUTEINTRASTEP ProcessID='Intrastep', ProcessList=1-%max_threads%

; EA skims - use NT
MW[1] = MI.4.daptime
MW[2] = MI.4.daptoll
MW[3] = MI.4.dantime
MW[4] = MI.4.dantoll
MW[5] = MI.4.dapdist
MW[6] = MI.4.a2ptime
MW[7] = MI.4.a2ptoll
MW[8] = MI.4.a2ntime
MW[9] = MI.4.a2ntoll
MW[10] = MI.4.a2pdist
MW[11] = MI.4.a3ptime
MW[12] = MI.4.a3ptoll
MW[13] = MI.4.a3ntime
MW[14] = MI.4.a3ntoll
MW[15] = MI.4.a3pdist

; AM Skims
MW[16] = MI.1.daptime
MW[17] = MI.1.daptoll
MW[18] = MI.1.dantime
MW[19] = MI.1.dantoll
MW[20] = MI.1.dapdist
MW[21] = MI.1.a2ptime
MW[22] = MI.1.a2ptoll
MW[23] = MI.1.a2ntime
MW[24] = MI.1.a2ntoll
MW[25] = MI.1.a2pdist
MW[26] = MI.1.a3ptime
MW[27] = MI.1.a3ptoll
MW[28] = MI.1.a3ntime
MW[29] = MI.1.a3ntoll
MW[30] = MI.1.a3pdist

; MD Skims
MW[31] = MI.2.daptime
MW[32] = MI.2.daptoll
MW[33] = MI.2.dantime
MW[34] = MI.2.dantoll
MW[35] = MI.2.dapdist
MW[36] = MI.2.a2ptime
MW[37] = MI.2.a2ptoll
MW[38] = MI.2.a2ntime
MW[39] = MI.2.a2ntoll
MW[40] = MI.2.a2pdist
MW[41] = MI.2.a3ptime
MW[42] = MI.2.a3ptoll
MW[43] = MI.2.a3ntime
MW[44] = MI.2.a3ntoll
MW[45] = MI.2.a3pdist

; PM Skims
MW[46] = MI.3.daptime
MW[47] = MI.3.daptoll
MW[48] = MI.3.dantime
MW[49] = MI.3.dantoll
MW[50] = MI.3.dapdist
MW[51] = MI.3.a2ptime
MW[52] = MI.3.a2ptoll
MW[53] = MI.3.a2ntime
MW[54] = MI.3.a2ntoll
MW[55] = MI.3.a2pdist
MW[56] = MI.3.a3ptime
MW[57] = MI.3.a3ptoll
MW[58] = MI.3.a3ntime
MW[59] = MI.3.a3ntoll
MW[60] = MI.3.a3pdist

ENDRUN

RUN PGM = MATRIX MSG='Prepare Skims for ActivitySim (High VoT)'
FILEI MATI[1] = "%SCENARIO_DIR%\highway\HWY_SKIM_%PREV_ITER%_AM_H.skm"
FILEI MATI[2] = "%SCENARIO_DIR%\highway\HWY_SKIM_%PREV_ITER%_MD_H.skm"
FILEI MATI[3] = "%SCENARIO_DIR%\highway\HWY_SKIM_%PREV_ITER%_PM_H.skm"
FILEI MATI[4] = "%SCENARIO_DIR%\highway\HWY_SKIM_%PREV_ITER%_NT_H.skm"
FILEO MATO[1] = "%SCENARIO_DIR%\highway\allskims_%PREV_ITER%_H.mat",  MO=1-60, 1-15,
NAME=
	SOV_P_TIME_H__EA, SOV_P_TOLL_H__EA, SOV_N_TIME_H__EA, SOV_N_TOLL_H__EA, SOV_DIST_H__EA, 
	HOV2_P_TIME_H__EA, HOV2_P_TOLL_H__EA, HOV2_N_TIME_H__EA, HOV2_N_TOLL_H__EA, HOV2_DIST_H__EA, 
	HOV3_P_TIME_H__EA, HOV3_P_TOLL_H__EA, HOV3_N_TIME_H__EA, HOV3_N_TOLL_H__EA, HOV3_DIST_H__EA, 
	SOV_P_TIME_H__AM, SOV_P_TOLL_H__AM, SOV_N_TIME_H__AM, SOV_N_TOLL_H__AM, SOV_DIST_H__AM, 
	HOV2_P_TIME_H__AM, HOV2_P_TOLL_H__AM, HOV2_N_TIME_H__AM, HOV2_N_TOLL_H__AM, HOV2_DIST_H__AM,
	HOV3_P_TIME_H__AM, HOV3_P_TOLL_H__AM, HOV3_N_TIME_H__AM, HOV3_N_TOLL_H__AM, HOV3_DIST_H__AM, 
	SOV_P_TIME_H__MD, SOV_P_TOLL_H__MD, SOV_N_TIME_H__MD, SOV_N_TOLL_H__MD, SOV_DIST_H__MD,
	HOV2_P_TIME_H__MD, HOV2_P_TOLL_H__MD, HOV2_N_TIME_H__MD, HOV2_N_TOLL_H__MD, HOV2_DIST_H__MD, 
	HOV3_P_TIME_H__MD, HOV3_P_TOLL_H__MD, HOV3_N_TIME_H__MD, HOV3_N_TOLL_H__MD, HOV3_DIST_H__MD, 
	SOV_P_TIME_H__PM, SOV_P_TOLL_H__PM, SOV_N_TIME_H__PM, SOV_N_TOLL_H__PM, SOV_DIST_H__PM, 
	HOV2_P_TIME_H__PM, HOV2_P_TOLL_H__PM, HOV2_N_TIME_H__PM, HOV2_N_TOLL_H__PM, HOV2_DIST_H__PM, 
	HOV3_P_TIME_H__PM, HOV3_P_TOLL_H__PM, HOV3_N_TIME_H__PM, HOV3_N_TOLL_H__PM, HOV3_DIST_H__PM, 
	SOV_P_TIME_H__NT, SOV_P_TOLL_H__NT, SOV_N_TIME_H__NT, SOV_N_TOLL_H__NT, SOV_DIST_H__NT, 
	HOV2_P_TIME_H__NT, HOV2_P_TOLL_H__NT, HOV2_N_TIME_H__NT, HOV2_N_TOLL_H__NT, HOV2_DIST_H__NT, 
	HOV3_P_TIME_H__NT, HOV3_P_TOLL_H__NT, HOV3_N_TIME_H__NT, HOV3_N_TOLL_H__NT, HOV3_DIST_H__NT
	
DISTRIBUTEINTRASTEP ProcessID='Intrastep', ProcessList=1-%max_threads%

; EA skims - use NT
MW[1] = MI.4.daptime
MW[2] = MI.4.daptoll
MW[3] = MI.4.dantime
MW[4] = MI.4.dantoll
MW[5] = MI.4.dapdist
MW[6] = MI.4.a2ptime
MW[7] = MI.4.a2ptoll
MW[8] = MI.4.a2ntime
MW[9] = MI.4.a2ntoll
MW[10] = MI.4.a2pdist
MW[11] = MI.4.a3ptime
MW[12] = MI.4.a3ptoll
MW[13] = MI.4.a3ntime
MW[14] = MI.4.a3ntoll
MW[15] = MI.4.a3pdist

; AM Skims
MW[16] = MI.1.daptime
MW[17] = MI.1.daptoll
MW[18] = MI.1.dantime
MW[19] = MI.1.dantoll
MW[20] = MI.1.dapdist
MW[21] = MI.1.a2ptime
MW[22] = MI.1.a2ptoll
MW[23] = MI.1.a2ntime
MW[24] = MI.1.a2ntoll
MW[25] = MI.1.a2pdist
MW[26] = MI.1.a3ptime
MW[27] = MI.1.a3ptoll
MW[28] = MI.1.a3ntime
MW[29] = MI.1.a3ntoll
MW[30] = MI.1.a3pdist

; MD Skims
MW[31] = MI.2.daptime
MW[32] = MI.2.daptoll
MW[33] = MI.2.dantime
MW[34] = MI.2.dantoll
MW[35] = MI.2.dapdist
MW[36] = MI.2.a2ptime
MW[37] = MI.2.a2ptoll
MW[38] = MI.2.a2ntime
MW[39] = MI.2.a2ntoll
MW[40] = MI.2.a2pdist
MW[41] = MI.2.a3ptime
MW[42] = MI.2.a3ptoll
MW[43] = MI.2.a3ntime
MW[44] = MI.2.a3ntoll
MW[45] = MI.2.a3pdist

; PM Skims
MW[46] = MI.3.daptime
MW[47] = MI.3.daptoll
MW[48] = MI.3.dantime
MW[49] = MI.3.dantoll
MW[50] = MI.3.dapdist
MW[51] = MI.3.a2ptime
MW[52] = MI.3.a2ptoll
MW[53] = MI.3.a2ntime
MW[54] = MI.3.a2ntoll
MW[55] = MI.3.a2pdist
MW[56] = MI.3.a3ptime
MW[57] = MI.3.a3ptoll
MW[58] = MI.3.a3ntime
MW[59] = MI.3.a3ntoll
MW[60] = MI.3.a3pdist

ENDRUN

CONVERTMAT FROM="%SCENARIO_DIR%\transit\trnskims_%PREV_ITER%.mat" TO="%SCENARIO_DIR%\OMX\trnskims.omx" COMPRESSION=4
CONVERTMAT FROM="%SCENARIO_DIR%\highway\allskims_%PREV_ITER%_L.mat" TO="%SCENARIO_DIR%\OMX\allskims_L.omx" COMPRESSION=4
CONVERTMAT FROM="%SCENARIO_DIR%\highway\allskims_%PREV_ITER%_M.mat" TO="%SCENARIO_DIR%\OMX\allskims_M.omx" COMPRESSION=4
CONVERTMAT FROM="%SCENARIO_DIR%\highway\allskims_%PREV_ITER%_H.mat" TO="%SCENARIO_DIR%\OMX\allskims_H.omx" COMPRESSION=4